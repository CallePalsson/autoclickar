import pyautogui
import time
import threading
import tkinter as tk
import keyboard  # For hotkeys

# Global variable to control the clicking
clicking = False

# Function that starts autoclicking with a user-defined interval
def start_autoclicker(interval):
    global clicking
    clicking = True
    while clicking:
        pyautogui.click()  # Click the mouse
        time.sleep(interval)  # Wait for the user-defined interval before clicking again

# Function to stop autoclicking
def stop_autoclicker():
    global clicking
    clicking = False
    status_label.config(text="Autoclicker stopped")

# Function to start clicking (from button click in GUI)
def start_clicking():
    try:
        # Get the interval from the user input
        interval = float(entry_interval.get())
        if interval <= 0:
            status_label.config(text="Please enter a positive number for the interval.")
            return

        # Update the status label
        status_label.config(text="Autoclicker running...")
        
        # Start the clicking process in a separate thread
        threading.Thread(target=start_autoclicker, args=(interval,), daemon=True).start()

    except ValueError:
        # Handle invalid user input
        status_label.config(text="Please enter a valid number for the interval.")

# Function to stop clicking (from button click in GUI)
def stop_clicking():
    stop_autoclicker()  # Stop the clicking

# Function to toggle clicking with hotkey (F8)
def toggle_clicking_with_hotkey():
    global clicking
    interval = float(entry_interval.get())
    if clicking:
        stop_autoclicker()  # Stop clicking
    else:
        status_label.config(text="Autoclicker running...")
        threading.Thread(target=start_autoclicker, args=(interval,), daemon=True).start()  # Start clicking in the background

# Function to listen for the hotkey (F8) in a separate thread
def listen_for_hotkey():
    while True:
        if keyboard.is_pressed('F8'):  # When F8 is pressed
            toggle_clicking_with_hotkey()  # Toggle start/stop of autoclicker

# Create the main window (GUI)
root = tk.Tk()
root.title("Autoclicker")

# Create GUI components
label_interval = tk.Label(root, text="Click Interval (seconds):")
label_interval.pack()

entry_interval = tk.Entry(root)
entry_interval.insert(0, "0.1")  # Default to 0.1 seconds
entry_interval.pack()

start_button = tk.Button(root, text="Start Clicking", command=start_clicking)
start_button.pack()

stop_button = tk.Button(root, text="Stop Clicking", command=stop_clicking)
stop_button.pack()

# Status label to show whether autoclicker is active or stopped
status_label = tk.Label(root, text="Autoclicker stopped")
status_label.pack()

# Start a separate thread to listen for the hotkey (F8)
threading.Thread(target=listen_for_hotkey, daemon=True).start()

# Start the GUI
root.mainloop()
